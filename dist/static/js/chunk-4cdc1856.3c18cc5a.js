(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4cdc1856"],{"0a92":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shape-container",style:{top:t.position.top+"%",left:t.position.left+"%",width:t.position.width+"%",height:t.position.height+"%"}},[a("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(t.name))]),t._v(" "),a("svg",[a("polygon",{attrs:{points:t.pointsString}})])],1)},r=[];a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}))},"2d45":function(t,e,a){},"30dc":function(t,e,a){},3543:function(t,e,a){"use strict";a.r(e);var n=a("b728"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},"360f":function(t,e,a){"use strict";var n=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a481");var r=n(a("bc3a")),i=a("6087"),o=n(a("a78e")),s={name:"DashboardFooter",props:{name:{type:String,default:function(){return""}},avatar:{type:String,default:function(){return""}},city:{type:String,default:function(){return""}}},data:function(){return{WEATHER_API_KEY:"81aba3f8c07ad627f67cf74bf53ee23a",timeInterval:""}},watch:{city:{immediate:!0,handler:"getWeatherApi"}},mounted:function(){this.currentDateTime()},methods:{currentDateTime:function(){var t=this;clearInterval(t.timeInterval);var e=o.default.get("language"),a=["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"];"en"===e&&(a=["Sunday","Monday","Tuesday","Wenesday","Thurday","Friday","Saturday"]);var n=function(){var e=new Date,n=(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes(),r=":"+(e.getSeconds()<10?"0":"")+e.getSeconds(),i=t.city+", "+a[e.getDay()]+" "+(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),o=document.getElementById("hourMin"),s=document.getElementById("second"),c=document.getElementById("timeRegion");"undefined"!==typeof o&&null!=o&&"undefined"!==typeof s&&null!=s&&"undefined"!==typeof c&&null!=c?(o.innerText=n,s.innerText=r,c.innerText=i):clearInterval(t.timeInterval)};n(),t.timeInterval=setInterval(n,1e3)},getWeatherApi:function(){var t=this.city;"Hồ Chí Minh"===t&&(t="Ho Chi Minh City"),"Hải Phòng"===t&&(t="Haiphong"),t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D");var e=(0,r.default)({url:"https://api.openweathermap.org/data/2.5/weather?q=".concat(t,",vn&appid=").concat(this.WEATHER_API_KEY),method:"get",data:e}).then((function(t){var e=t.data&&Math.floor(t.data.main.temp-273.15),a=t.data&&t.data.weather[0].icon,n=document.getElementById("minTemp"),r=document.getElementById("imgWeather"),i="https://openweathermap.org/img/wn/".concat(a,"@2x.png");n.innerText=e,r.setAttribute("src",i)}));return e},generateTitleView:i.generateTitleView}};e.default=s},3661:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"dashboard-container"},[a("dashboard-footer",{attrs:{name:t.name,city:t.city},on:{"update:city":function(e){t.city=e}}}),t._v(" "),a("v-container",{staticClass:"v-container",attrs:{fluid:""}},[a("dashboard-map")],1)],1)])},r=[];a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}))},"3d12":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"SvgShape",props:{name:{type:String,default:""},position:{type:Object,default:function(){return[]}},points:{type:Array,default:function(){return[]}}},computed:{pointsString:function(){var t=[];if(0!==this.points.length){var e=[];e.push(this.points[0]),e.push([this.points[0][0],this.points[1][1]]),e.push(this.points[1]),e.push([this.points[1][0],this.points[0][0]]),t=e.map((function(t){return t[0]+","+t[1]}),this)}return t.join(" ")}}};e.default=n},"4e75":function(t,e,a){"use strict";var n=a("2d45"),r=a.n(n);r.a},7241:function(t,e,a){"use strict";a.r(e);var n=a("865e7"),r=a("3543");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("9fcb");var o=a("2877"),s=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"840487dc",null);e["default"]=s.exports},7309:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hotel-footer"},[n("div",{staticClass:"region-date"},[t._m(0),t._v(" "),n("div",{staticClass:"region_bottom"},[n("div",{staticClass:"hello-user"},[n("p",{staticClass:"hello"},[t._v(t._s(t.generateTitleView("hello","dashboard"))+", "),n("b",[t._v(t._s(t.name))])])])])]),t._v(" "),n("div",{staticClass:"weather-user"},[n("div",{staticClass:"doctor-weather__inner",style:{"background-image":"url("+a("5751")+")"}},[t._m(1)])])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"region_top"},[a("div",{staticClass:"time"},[a("span",{staticClass:"hour-min",attrs:{id:"hourMin"}}),a("span",{staticClass:"sec",attrs:{id:"second"}})]),t._v(" "),a("div",{staticClass:"region",attrs:{id:"timeRegion"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"weather"},[a("img",{staticClass:"img-weather",attrs:{id:"imgWeather",src:"https://openweathermap.org/img/wn/03d@2x.png",alt:""}}),t._v(" "),a("p",{staticClass:"temperature"},[a("span",{attrs:{id:"minTemp"}},[t._v("24")]),a("span",{staticClass:"temp-sign"}),t._v("C")])])}];a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}))},"865e7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"robot-run-container",class:{none:0===t.left&&0===t.top},style:t.style},[n("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(t.title))]),t._v(" "),n("img",{staticClass:"imgRobot",attrs:{src:a("1771")("./"+t.icon),alt:""}})],1)},r=[];a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}))},8720:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}]},t._l(t.listAllChildArea,(function(e,r){return n("v-card",{key:r,staticClass:"mapWrapper"},[n("v-row",[n("v-col",{attrs:{md:"12"}},[n("div",{staticClass:"area-title"},[n("span",{staticClass:"area-title-value"},[t._v("\n            "+t._s(e.parentName)+" - "+t._s(e.name)+"\n          ")]),t._v(" "),e.robots?n("div",{staticClass:"robot-list_wrap"},t._l(e.robots,(function(e,r){return n("div",{key:r,staticClass:"robot_list__item"},[n("span",{staticClass:"robot-value"},[t._v("\n                "+t._s(e.name)+"\n\n                "),n("img",{staticClass:"imgRobot",staticStyle:{width:"25px"},attrs:{src:a("1771")("./"+e.icon),alt:""}}),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.generateTitleView("robotControl","dashboard"),placement:"top"}},[n("el-button",{staticClass:"btn-videocall",attrs:{icon:"el-icon-rank"},on:{click:function(a){return t.redirectRobotControl(e)}}})],1),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.generateTitleView("videoCall","dashboard"),placement:"top"}},[n("el-button",{staticClass:"btn-videocall",attrs:{icon:"el-icon-video-camera"},on:{click:function(a){return t.redirectVideoCall(e)}}},[n("font-awesome-icon",{attrs:{icon:"video"}})],1)],1)],1)])})),0):t._e()]),t._v(" "),n("div",{staticClass:"map-container",attrs:{id:"map-"+e.id}},[n("svg",{staticClass:"svgEditor"},[n("defs",[n("marker",{attrs:{id:"red-arrowhead",viewBox:"0 0 10 10",refX:"7",refY:"5",markerUnits:"strokeWidth",markerWidth:"5",markerHeight:"4",orient:"auto"}},[n("path",{attrs:{d:"M 0 0 L 10 5 L 0 10 z",stroke:"none",fill:"red"}})])]),t._v(" "),t._l(e.robots,(function(e){return e.px?n("line",{staticClass:"line",attrs:{x1:e.px,x2:e.arrowX,y1:e.py,y2:e.arrowY,stroke:"red","marker-end":"url(#red-arrowhead)","stroke-width":"4"}}):t._e()}))],2),t._v(" "),t._l(e.robots,(function(a){return e.robots.length>0?n("svg-robot",{key:a.id,attrs:{title:a.name,icon:a.icon,left:a.mapWidth,top:a.mapHeight}}):t._e()})),t._v(" "),t._l(t.resultList[r],(function(t,e){return n("svg-shape",{key:e,attrs:{position:t.position,points:t.newPoints,name:t.name}})})),t._v(" "),n("img",{ref:"map"+e.id,refInFor:!0,staticClass:"imgMap",attrs:{src:t.folderUpload+e.thumb}})],2)])],1)],1)})),1)},r=[];a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}))},"8b66":function(t,e,a){"use strict";a.r(e);var n=a("a6b8"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},"97ab":function(t,e,a){"use strict";a.r(e);var n=a("360f"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},"9a78":function(t,e,a){"use strict";var n=a("dbce"),r=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(a("ded3")),o=r(a("6374")),s=a("2f62"),c=a("6087"),u=n(a("b134")),l=r(a("c499")),d=r(a("7241")),f=r(a("428d")),p={model:"dashboard/",area:"area/"},h={name:"DashboardMap",directives:{resize:f.default},components:{SvgShape:l.default,SvgRobot:d.default},data:function(){return{isLoading:!1,folderUpload:"https://172.20.10.2:9000/agency/Images/User//",objectList:[],resultList:[],socket:null}},watch:{listAllChildArea:{deep:!0,handler:function(t){var e,a=(0,o.default)(t);try{for(a.s();!(e=a.n()).done;){var n=e.value,r="#map-"+n.id;if(null!=document.querySelector(r)){var i,s=document.querySelector(r).offsetWidth,c=document.querySelector(r).offsetHeight,u=(0,o.default)(n.robots);try{for(u.s();!(i=u.n()).done;){var l=i.value;if(void 0!==l.point_x){var d=[],f=Math.round(l.point_x/l.map.width*100*s/100/100),p=Math.round(l.point_y/l.map.height*100*c/100/100);d.push(f),d.push(p),l.px=f,l.py=p;var h=parseInt(l.deg),v=d[0]+30*Math.cos(this.convertDeg(h)*Math.PI/180),m=d[1]+30*Math.sin(this.convertDeg(h)*Math.PI/180);l.arrowX=v,l.arrowY=m}}}catch(g){u.e(g)}finally{u.f()}}}}catch(g){a.e(g)}finally{a.f()}}}},computed:(0,i.default)((0,i.default)({},(0,s.mapGetters)({listRobots:p.model+"listRobots",currentFloor:p.model+"currentFloor",currentMapObject:p.model+"currentMapObject",listAllChildArea:p.model+"listAllChildArea",user_id:"userId",userType:"userType"})),{},{cameraList:function(){var t=this.objectList.filter((function(t){return"camera"===t.type}));return t}}),mounted:function(){var t=this;this.actGetListParent().then((function(){t.actGetAllChildArea({UserId:t.user_id,UserType:t.userType}).then((function(){setTimeout(function(){this.initMap()}.bind(t),100)}))})),this.sockets=this.initSocket()},destroyed:function(){this.sockets.close()},methods:(0,i.default)((0,i.default)((0,i.default)({},(0,s.mapActions)({actGetListParent:p.model+u.ACT_FETCH_AREA_PARENT,actFilterArea:p.model+u.ACT_FETCH_AREA_ALL,actFilterRobot:p.model+u.ACT_FETCH_ROBOT,actGetAllChildArea:p.model+u.ACT_GET_ALL_CHILD_AREA})),(0,s.mapMutations)({mutSetCurrentMapObject:p.model+u.MUTATION_SET_CURRENT_MAP_OBJECT,mutUpdateRobotPosition:p.model+u.MUTATION_UPDATE_POSITION_ROBOT})),{},{generateTitleView:c.generateTitleView,onChangeAreaParent:function(t){this.actFilterArea({ParentId:t})},initMap:function(){this.resultList=[];var t,e=(0,o.default)(this.listAllChildArea);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(a.jsonData){var n="#map-"+a.id,r=document.querySelector(n).offsetWidth,i=JSON.parse(a.jsonData),s=i.sizeMap,c=r/s.w,u=this.caclPosition(c,a);this.resultList.push(u)}else this.resultList.push([])}}catch(l){e.e(l)}finally{e.f()}},caclPosition:function(t,e){var a,n=JSON.parse(e.jsonData),r=n.sizeMap,i=n.objectList,s=(0,o.default)(i);try{for(s.s();!(a=s.n()).done;){var c=a.value;if("object"===c.type){var u=c.points,l=JSON.parse(JSON.stringify(u));l.pop();var d,f=[],p=[],h=(0,o.default)(l);try{for(h.s();!(d=h.n()).done;){var v=d.value;f.push(v.x),p.push(v.y)}}catch(E){h.e(E)}finally{h.f()}var m=[Math.min.apply(Math,f),Math.min.apply(Math,p)],g=[Math.max.apply(Math,f),Math.max.apply(Math,p)],b=m[0]/r.w*100,_=m[1]/r.h*100,y=(g[0]-m[0])/r.w*100,C=(g[1]-m[1])/r.h*100,w={left:b,top:_,width:y,height:C};c.position=w;var T,M=[],A=(0,o.default)(l);try{for(A.s();!(T=A.n()).done;){var k=T.value,S=[Math.round((k.x-m[0])*t),Math.round((k.y-m[1])*t)];M.push(S)}}catch(E){A.e(E)}finally{A.f()}c.newPoints=M}}}catch(E){s.e(E)}finally{s.f()}return i},onResize:function(){this.initMap()},redirectVideoCall:function(t){window.location.href="/#/users/robots/call/"+t.id},redirectRobotControl:function(t){window.location.href="/#/users/robots/control/"+t.id},initSocket:function(){var t="wss://172.20.10.2:9000/agency/downloadMedia",e=new WebSocket(t),a=this;return e.onopen=function(){console.log("Connected")},e.onclose=function(t){t.wasClean?console.log("Disconnected."):console.log("Connection lost."),console.log("Code: "+t.code+". Reason: "+t.reason),setTimeout((function(){a.initSocket()}),1e3)},e.onmessage=function(t){var e=t.data;"@"===e[0]&&a.mutUpdateRobotPosition(e)},e.onerror=function(t){console.log("Error: "+t.message)},e},convertDeg:function(t){return-t}})};e.default=h},"9b48":function(t,e,a){"use strict";a.r(e);var n=a("3661"),r=a("8b66");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("4e75");var o=a("2877"),s=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"4a5f9182",null);e["default"]=s.exports},"9fcb":function(t,e,a){"use strict";var n=a("c720"),r=a.n(n);r.a},a506:function(t,e,a){},a609:function(t,e,a){"use strict";a.r(e);var n=a("9a78"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},a6b8:function(t,e,a){"use strict";var n=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("f559");var r=n(a("ded3")),i=n(a("a78e")),o=a("2f62"),s=n(a("f9a4")),c=n(a("fd71")),u={name:"HomeDashboard",components:{DashboardFooter:s.default,DashboardMap:c.default},data:function(){return{city:i.default.get("cookieCity")||"Hà Nội",background:i.default.get("backgroundAgency")||"#0095B6",backgroundUrl:""}},computed:(0,r.default)({},(0,o.mapGetters)(["name","avatar"])),watch:{background:{immediate:!0,handler:function(t){t.startsWith("http")?this.backgroundUrl="background-image: url(".concat(t,"); background-repeat: no-repeat; background-size: cover;"):this.backgroundUrl="background: ".concat(t,";")}}},mounted:function(){this.$store.commit("app/CHANGE_APP_TITLE","HỆ THỐNG GIÁM SÁT ROBOT"),this.$store.commit("app/CLOSE_SIDEBAR")}};e.default=u},b1e2:function(t,e,a){"use strict";var n=a("e70a"),r=a.n(n);r.a},b728:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c5f6");var n={name:"SvgRobot",props:{name:{type:String,default:""},left:{type:Number,default:0},top:{type:Number,default:0},width:{type:Number,default:0},title:{type:String,default:""},icon:{type:String,default:"robot1.svg"}},computed:{style:function(){return{left:"calc("+this.left+"% - 15px)",top:"calc("+this.top+"% - 15px)"}}}};e.default=n},b7ff:function(t,e,a){"use strict";var n=a("30dc"),r=a.n(n);r.a},c499:function(t,e,a){"use strict";a.r(e);var n=a("0a92"),r=a("d813");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("f0b8");var o=a("2877"),s=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"2a9ae139",null);e["default"]=s.exports},c720:function(t,e,a){},d813:function(t,e,a){"use strict";a.r(e);var n=a("3d12"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},e70a:function(t,e,a){},f0b8:function(t,e,a){"use strict";var n=a("a506"),r=a.n(n);r.a},f559:function(t,e,a){"use strict";var n=a("5ca1"),r=a("9def"),i=a("d2c8"),o="startsWith",s=""[o];n(n.P+n.F*a("5147")(o),"String",{startsWith:function(t){var e=i(this,t,o),a=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return s?s.call(e,n,a):e.slice(a,a+n.length)===n}})},f9a4:function(t,e,a){"use strict";a.r(e);var n=a("7309"),r=a("97ab");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("b7ff");var o=a("2877"),s=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"cc48ec3a",null);e["default"]=s.exports},fd71:function(t,e,a){"use strict";a.r(e);var n=a("8720"),r=a("a609");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("b1e2");var o=a("2877"),s=Object(o["a"])(r["default"],n["a"],n["b"],!1,null,"75cf74b5",null);e["default"]=s.exports}}]);