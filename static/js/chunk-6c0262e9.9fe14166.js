(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c0262e9"],{"2d45":function(t,e,a){},"30dc":function(t,e,a){},"4e75":function(t,e,a){"use strict";var n=a("2d45"),i=a.n(n);i.a},7241:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"robot-run-container",class:{none:0===t.left&&0===t.top},style:t.style},[n("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(t.title))]),t._v(" "),n("img",{staticClass:"imgRobot",attrs:{src:a("1771")("./"+t.icon),alt:""}})],1)},i=[],o=(a("c5f6"),{name:"SvgRobot",props:{name:{type:String,default:""},left:{type:Number,default:0},top:{type:Number,default:0},width:{type:Number,default:0},title:{type:String,default:""},icon:{type:String,default:"robot1.svg"}},computed:{style:function(){return{left:"calc("+this.left+"% - 15px)",top:"calc("+this.top+"% - 15px)"}}}}),r=o,s=(a("9fcb"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"840487dc",null);e["a"]=c.exports},"9b48":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"dashboard-container"},[a("dashboard-footer",{attrs:{name:t.name,city:t.city},on:{"update:city":function(e){t.city=e}}}),t._v(" "),a("v-container",{staticClass:"v-container",attrs:{fluid:""}},[a("dashboard-map")],1)],1)])},i=[],o=(a("f559"),a("5530")),r=a("a78e"),s=a.n(r),c=a("2f62"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hotel-footer"},[n("div",{staticClass:"region-date"},[t._m(0),t._v(" "),n("div",{staticClass:"region_bottom"},[n("div",{staticClass:"hello-user"},[n("p",{staticClass:"hello"},[t._v(t._s(t.generateTitleView("hello","dashboard"))+", "),n("b",[t._v(t._s(t.name))])])])])]),t._v(" "),n("div",{staticClass:"weather-user"},[n("div",{staticClass:"doctor-weather__inner",style:{"background-image":"url("+a("5751")+")"}},[t._m(1)])])])},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"region_top"},[a("div",{staticClass:"time"},[a("span",{staticClass:"hour-min",attrs:{id:"hourMin"}}),a("span",{staticClass:"sec",attrs:{id:"second"}})]),t._v(" "),a("div",{staticClass:"region",attrs:{id:"timeRegion"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"weather"},[a("img",{staticClass:"img-weather",attrs:{id:"imgWeather",src:"https://openweathermap.org/img/wn/03d@2x.png",alt:""}}),t._v(" "),a("p",{staticClass:"temperature"},[a("span",{attrs:{id:"minTemp"}},[t._v("24")]),a("span",{staticClass:"temp-sign"}),t._v("C")])])}],d=(a("a481"),a("bc3a")),p=a.n(d),h=a("6087"),f={name:"DashboardFooter",props:{name:{type:String,default:function(){return""}},avatar:{type:String,default:function(){return""}},city:{type:String,default:function(){return""}}},data:function(){return{WEATHER_API_KEY:"81aba3f8c07ad627f67cf74bf53ee23a",timeInterval:""}},watch:{city:{immediate:!0,handler:"getWeatherApi"}},mounted:function(){this.currentDateTime()},methods:{currentDateTime:function(){var t=this;clearInterval(t.timeInterval);var e=s.a.get("language"),a=["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"];"en"===e&&(a=["Sunday","Monday","Tuesday","Wenesday","Thurday","Friday","Saturday"]);var n=function(){var e=new Date,n=(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes(),i=":"+(e.getSeconds()<10?"0":"")+e.getSeconds(),o=t.city+", "+a[e.getDay()]+" "+(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),r=document.getElementById("hourMin"),s=document.getElementById("second"),c=document.getElementById("timeRegion");"undefined"!==typeof r&&null!=r&&"undefined"!==typeof s&&null!=s&&"undefined"!==typeof c&&null!=c?(r.innerText=n,s.innerText=i,c.innerText=o):clearInterval(t.timeInterval)};n(),t.timeInterval=setInterval(n,1e3)},getWeatherApi:function(){var t=this.city;"Hồ Chí Minh"===t&&(t="Ho Chi Minh City"),"Hải Phòng"===t&&(t="Haiphong"),t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D");var e=p()({url:"https://api.openweathermap.org/data/2.5/weather?q=".concat(t,",vn&appid=").concat(this.WEATHER_API_KEY),method:"get",data:e}).then((function(t){var e=t.data&&Math.floor(t.data.main.temp-273.15),a=t.data&&t.data.weather[0].icon,n=document.getElementById("minTemp"),i=document.getElementById("imgWeather"),o="https://openweathermap.org/img/wn/".concat(a,"@2x.png");n.innerText=e,i.setAttribute("src",o)}));return e},generateTitleView:h["b"]}},m=f,v=(a("b7ff"),a("2877")),g=Object(v["a"])(m,l,u,!1,null,"cc48ec3a",null),b=g.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}]},t._l(t.listAllChildArea,(function(e,i){return n("v-card",{key:i,staticClass:"mapWrapper"},[n("v-row",[n("v-col",{attrs:{md:"12"}},[n("div",{staticClass:"area-title"},[n("span",{staticClass:"area-title-value"},[t._v("\n            "+t._s(e.parentName)+" - "+t._s(e.name)+"\n          ")]),t._v(" "),e.robots?n("div",{staticClass:"robot-list_wrap"},t._l(e.robots,(function(e,i){return n("div",{key:i,staticClass:"robot_list__item"},[n("span",{staticClass:"robot-value"},[t._v("\n                "+t._s(e.name)+"\n\n                "),n("img",{staticClass:"imgRobot",staticStyle:{width:"25px"},attrs:{src:a("1771")("./"+e.icon),alt:""}}),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.generateTitleView("robotControl","dashboard"),placement:"top"}},[n("el-button",{staticClass:"btn-videocall",attrs:{icon:"el-icon-rank"},on:{click:function(a){return t.redirectRobotControl(e)}}})],1),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.generateTitleView("videoCall","dashboard"),placement:"top"}},[n("el-button",{staticClass:"btn-videocall",attrs:{icon:"el-icon-video-camera"},on:{click:function(a){return t.redirectVideoCall(e)}}},[n("font-awesome-icon",{attrs:{icon:"video"}})],1)],1)],1)])})),0):t._e()]),t._v(" "),n("div",{staticClass:"map-container",attrs:{id:"map-"+e.id}},[n("svg",{staticClass:"svgEditor"},[n("defs",[n("marker",{attrs:{id:"red-arrowhead",viewBox:"0 0 10 10",refX:"7",refY:"5",markerUnits:"strokeWidth",markerWidth:"5",markerHeight:"4",orient:"auto"}},[n("path",{attrs:{d:"M 0 0 L 10 5 L 0 10 z",stroke:"none",fill:"red"}})])]),t._v(" "),t._l(e.robots,(function(e){return e.px?n("line",{staticClass:"line",attrs:{x1:e.px,x2:e.arrowX,y1:e.py,y2:e.arrowY,stroke:"red","marker-end":"url(#red-arrowhead)","stroke-width":"4"}}):t._e()}))],2),t._v(" "),t._l(e.robots,(function(a){return e.robots.length>0?n("svg-robot",{key:a.id,attrs:{title:a.name,icon:a.icon,left:a.mapWidth,top:a.mapHeight}}):t._e()})),t._v(" "),t._l(t.resultList[i],(function(t,e){return n("svg-shape",{key:e,attrs:{position:t.position,points:t.newPoints,name:t.name}})})),t._v(" "),n("img",{ref:"map"+e.id,refInFor:!0,staticClass:"imgMap",attrs:{src:t.folderUpload+e.thumb}})],2)])],1)],1)})),1)},_=[],C=a("b85c"),w=a("b134"),k=a("c499"),M=a("7241"),S=a("428d"),j=a.n(S),T={model:"dashboard/",area:"area/"},O={name:"DashboardMap",directives:{resize:j.a},components:{SvgShape:k["a"],SvgRobot:M["a"]},data:function(){return{isLoading:!1,folderUpload:"https://172.20.10.2:9000/agency/Images/User//",objectList:[],resultList:[],socket:null}},watch:{listAllChildArea:{deep:!0,handler:function(t){var e,a=Object(C["a"])(t);try{for(a.s();!(e=a.n()).done;){var n=e.value,i="#map-"+n.id;if(null!=document.querySelector(i)){var o,r=document.querySelector(i).offsetWidth,s=document.querySelector(i).offsetHeight,c=Object(C["a"])(n.robots);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(void 0!==l.point_x){var u=[],d=Math.round(l.point_x/l.map.width*100*r/100/100),p=Math.round(l.point_y/l.map.height*100*s/100/100);u.push(d),u.push(p),l.px=d,l.py=p;var h=parseInt(l.deg),f=u[0]+30*Math.cos(this.convertDeg(h)*Math.PI/180),m=u[1]+30*Math.sin(this.convertDeg(h)*Math.PI/180);l.arrowX=f,l.arrowY=m}}}catch(v){c.e(v)}finally{c.f()}}}}catch(v){a.e(v)}finally{a.f()}}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["c"])({listRobots:T.model+"listRobots",currentFloor:T.model+"currentFloor",currentMapObject:T.model+"currentMapObject",listAllChildArea:T.model+"listAllChildArea",user_id:"userId",userType:"userType"})),{},{cameraList:function(){var t=this.objectList.filter((function(t){return"camera"===t.type}));return t}}),mounted:function(){var t=this;this.actGetListParent().then((function(){t.actGetAllChildArea({UserId:t.user_id,UserType:t.userType}).then((function(){setTimeout(function(){this.initMap()}.bind(t),100)}))})),this.sockets=this.initSocket()},destroyed:function(){this.sockets.close()},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(c["b"])({actGetListParent:T.model+w["b"],actFilterArea:T.model+w["a"],actFilterRobot:T.model+w["c"],actGetAllChildArea:T.model+w["d"]})),Object(c["d"])({mutSetCurrentMapObject:T.model+w["i"],mutUpdateRobotPosition:T.model+w["j"]})),{},{generateTitleView:h["b"],onChangeAreaParent:function(t){this.actFilterArea({ParentId:t})},initMap:function(){this.resultList=[];var t,e=Object(C["a"])(this.listAllChildArea);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(a.jsonData){var n="#map-"+a.id,i=document.querySelector(n).offsetWidth,o=JSON.parse(a.jsonData),r=o.sizeMap,s=i/r.w,c=this.caclPosition(s,a);this.resultList.push(c)}else this.resultList.push([])}}catch(l){e.e(l)}finally{e.f()}},caclPosition:function(t,e){var a,n=JSON.parse(e.jsonData),i=n.sizeMap,o=n.objectList,r=Object(C["a"])(o);try{for(r.s();!(a=r.n()).done;){var s=a.value;if("object"===s.type){var c=s.points,l=JSON.parse(JSON.stringify(c));l.pop();var u,d=[],p=[],h=Object(C["a"])(l);try{for(h.s();!(u=h.n()).done;){var f=u.value;d.push(f.x),p.push(f.y)}}catch(O){h.e(O)}finally{h.f()}var m=[Math.min.apply(Math,d),Math.min.apply(Math,p)],v=[Math.max.apply(Math,d),Math.max.apply(Math,p)],g=m[0]/i.w*100,b=m[1]/i.h*100,y=(v[0]-m[0])/i.w*100,_=(v[1]-m[1])/i.h*100,w={left:g,top:b,width:y,height:_};s.position=w;var k,M=[],S=Object(C["a"])(l);try{for(S.s();!(k=S.n()).done;){var j=k.value,T=[Math.round((j.x-m[0])*t),Math.round((j.y-m[1])*t)];M.push(T)}}catch(O){S.e(O)}finally{S.f()}s.newPoints=M}}}catch(O){r.e(O)}finally{r.f()}return o},onResize:function(){this.initMap()},redirectVideoCall:function(t){window.location.href="/#/users/robots/call/"+t.id},redirectRobotControl:function(t){window.location.href="/#/users/robots/control/"+t.id},initSocket:function(){var t="wss://172.20.10.2:9000/agency/downloadMedia",e=new WebSocket(t),a=this;return e.onopen=function(){console.log("Connected")},e.onclose=function(t){t.wasClean?console.log("Disconnected."):console.log("Connection lost."),console.log("Code: "+t.code+". Reason: "+t.reason),setTimeout((function(){a.initSocket()}),1e3)},e.onmessage=function(t){var e=t.data;"@"===e[0]&&a.mutUpdateRobotPosition(e)},e.onerror=function(t){console.log("Error: "+t.message)},e},convertDeg:function(t){return-t}})},A=O,x=(a("b1e2"),Object(v["a"])(A,y,_,!1,null,"75cf74b5",null)),I=x.exports,E={name:"HomeDashboard",components:{DashboardFooter:b,DashboardMap:I},data:function(){return{city:s.a.get("cookieCity")||"Hà Nội",background:s.a.get("backgroundAgency")||"#0095B6",backgroundUrl:""}},computed:Object(o["a"])({},Object(c["c"])(["name","avatar"])),watch:{background:{immediate:!0,handler:function(t){t.startsWith("http")?this.backgroundUrl="background-image: url(".concat(t,"); background-repeat: no-repeat; background-size: cover;"):this.backgroundUrl="background: ".concat(t,";")}}},mounted:function(){this.$store.commit("app/CHANGE_APP_TITLE","HỆ THỐNG GIÁM SÁT ROBOT"),this.$store.commit("app/CLOSE_SIDEBAR")}},D=E,R=(a("4e75"),Object(v["a"])(D,n,i,!1,null,"4a5f9182",null));e["default"]=R.exports},"9fcb":function(t,e,a){"use strict";var n=a("c720"),i=a.n(n);i.a},a506:function(t,e,a){},b1e2:function(t,e,a){"use strict";var n=a("e70a"),i=a.n(n);i.a},b7ff:function(t,e,a){"use strict";var n=a("30dc"),i=a.n(n);i.a},c499:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shape-container",style:{top:t.position.top+"%",left:t.position.left+"%",width:t.position.width+"%",height:t.position.height+"%"}},[a("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(t.name))]),t._v(" "),a("svg",[a("polygon",{attrs:{points:t.pointsString}})])],1)},i=[],o={name:"SvgShape",props:{name:{type:String,default:""},position:{type:Object,default:function(){return[]}},points:{type:Array,default:function(){return[]}}},computed:{pointsString:function(){var t=[];if(0!==this.points.length){var e=[];e.push(this.points[0]),e.push([this.points[0][0],this.points[1][1]]),e.push(this.points[1]),e.push([this.points[1][0],this.points[0][0]]),t=e.map((function(t){return t[0]+","+t[1]}),this)}return t.join(" ")}}},r=o,s=(a("f0b8"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"2a9ae139",null);e["a"]=c.exports},c720:function(t,e,a){},e70a:function(t,e,a){},f0b8:function(t,e,a){"use strict";var n=a("a506"),i=a.n(n);i.a},f559:function(t,e,a){"use strict";var n=a("5ca1"),i=a("9def"),o=a("d2c8"),r="startsWith",s=""[r];n(n.P+n.F*a("5147")(r),"String",{startsWith:function(t){var e=o(this,t,r),a=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return s?s.call(e,n,a):e.slice(a,a+n.length)===n}})}}]);